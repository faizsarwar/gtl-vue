"use strict";(self["webpackChunkmatic_academy"]=self["webpackChunkmatic_academy"]||[]).push([[695],{3860:function(t,e,s){s.d(e,{Z:function(){return x}});var i=s(3396),r=s(7139);const a=t=>((0,i.dD)("data-v-662769ec"),t=t(),(0,i.Cn)(),t),o={key:0,class:"m-0"},l=["href"],n={key:0},c={key:1},d={key:2},u={key:3},p={xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",style:{color:"green"},fill:"currentColor",class:"bi bi-dash",viewBox:"0 0 16 16"},m=a((()=>(0,i._)("path",{d:"M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z"},null,-1))),h=[m],_={xmlns:"http://www.w3.org/2000/svg",width:"25",height:"25",style:{color:"green"},fill:"currentColor",class:"bi bi-plus",viewBox:"0 0 16 16"},g=a((()=>(0,i._)("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"},null,-1))),f=[g];function w(t,e,s,a,m,g){return 0!=m.item.quantity?((0,i.wg)(),(0,i.iD)("tr",o,[(0,i._)("td",null,[(0,i._)("a",{href:"/products/"+m.item.product.id},(0,r.zw)(m.item.product.name),9,l)]),(0,i._)("td",null,(0,r.zw)(m.item.product.size),1),"Consumer"!=m.account_details.account_type&&1==m.account_details.approved?((0,i.wg)(),(0,i.iD)("td",n," $"+(0,r.zw)(m.item.price*m.discount),1)):"Consumer"!=m.account_details.account_type&&0==m.account_details.approved?((0,i.wg)(),(0,i.iD)("td",c," $"+(0,r.zw)(m.item.price),1)):1!=m.discount?((0,i.wg)(),(0,i.iD)("td",d," $"+(0,r.zw)(m.item.price*m.discount),1)):((0,i.wg)(),(0,i.iD)("td",u," $"+(0,r.zw)(m.item.price),1)),(0,i._)("td",null,[(0,i._)("a",{onClick:e[0]||(e[0]=t=>g.decrementQuantity(m.item))},[((0,i.wg)(),(0,i.iD)("svg",p,h))]),(0,i.Uk)(" "+(0,r.zw)(m.item.quantity)+" ",1),(0,i._)("a",{onClick:e[1]||(e[1]=t=>g.incrementQuantity(m.item))},[((0,i.wg)(),(0,i.iD)("svg",_,f))])]),(0,i._)("td",null,"$"+(0,r.zw)(g.getItemTotal(m.item).toFixed(2)),1)])):(0,i.kq)("",!0)}var y=s(6265),v=s.n(y),C={name:"CartItem",props:{initialItem:Object},data(){return{item:this.initialItem,account_details:[],discount:1}},mounted(){this.getAccountDetails()},methods:{getItemTotal(t){return"Consumer"!=this.account_details.account_type&&1==this.account_details.approved?t.quantity*t.price*this.discount:"Consumer"!=this.account_details.account_type&&0==this.account_details.approved?t.quantity*t.price:(this.discount,t.quantity*t.price*this.discount)},decrementQuantity(t){t.quantity-=1,0===t.quantity&&this.$emit("removeFromCart",t),this.updateCart()},incrementQuantity(t){t.quantity+=1,this.updateCart()},updateCart(){localStorage.setItem("cart",JSON.stringify(this.$store.state.cart))},removeFromCart(t){this.$emit("removeFromCart",t),this.updateCart()},getAccountDetails(){v().get(`/api/v1/CustomUser/${localStorage.getItem("userid")}/`).then((t=>{this.account_details=t.data,this.setDiscount()})).catch((t=>{console.log(t)}))},setDiscount(){console.log("hello ",this.account_details.account_type),"Retailer"==this.account_details.account_type?this.discount=.6:"Distributor"==this.account_details.account_type?(console.log("distributor"),this.discount=.4):this.discount=1}}},b=s(89);const k=(0,b.Z)(C,[["render",w],["__scopeId","data-v-662769ec"]]);var x=k},6695:function(t,e,s){s.r(e),s.d(e,{default:function(){return M}});var i=s(3396),r=s(7139),a=s(9242);const o=t=>((0,i.dD)("data-v-6ca4a9d6"),t=t(),(0,i.Cn)(),t),l={class:"page-checkout p-0 mt-0 mb-0"},n={class:"columns is-multiline"},c=o((()=>(0,i._)("div",{class:"column is-12"},[(0,i._)("h1",{class:"heading"},"Checkout")],-1))),d={class:"column is-12 box pr-5 pl-5"},u={key:0,class:"table is-fullwidth"},p=o((()=>(0,i._)("thead",null,[(0,i._)("tr",null,[(0,i._)("th",{class:"text-center"},"Product"),(0,i._)("th",{class:"text-center"},"size"),(0,i._)("th",{class:"text-center"},"Price"),(0,i._)("th",{class:"text-center"},"Quantity"),(0,i._)("th",{class:"text-center"},"Total"),(0,i._)("th",{class:"text-center"})])],-1))),m=o((()=>(0,i._)("td",{colspan:"2"},[(0,i._)("h4",null,[(0,i._)("b",null," Total ")])],-1))),h=o((()=>(0,i._)("td",null,null,-1))),_={class:"column is-12 box pl-5 pr-5 pb-5"},g=o((()=>(0,i._)("h2",{class:"heading mt-5"},"Shipping details",-1))),f=o((()=>(0,i._)("p",{class:"has-text-grey mb-5"},"* All fields are required",-1))),w={class:"ml-5 mr-5 pl-5 pr-5 mt-4"},y={class:"form-row pr-5 pl-5"},v={class:"form-group col-md-6"},C=o((()=>(0,i._)("p",{for:"inputEmail4",class:"form-label"},"Email",-1))),b={class:"form-group col-md-6"},k=o((()=>(0,i._)("p",{for:"inputPassword4 ",class:"form-label"},"Phone",-1))),x={class:"form-row pr-5 pl-5"},z={class:"form-group col"},D=o((()=>(0,i._)("p",{for:"inputCity",class:"form-label"},"First Name",-1))),T={class:"form-group col"},q=o((()=>(0,i._)("p",{for:"inputCity",class:"form-label"},"Last Name",-1))),I={class:"form-group col"},$=o((()=>(0,i._)("p",{for:"inputZip",class:"form-label"},"Zip",-1))),P={class:"form-group pr-5 pl-5"},A=o((()=>(0,i._)("p",{for:"inputAddress",class:"form-label"},"Address",-1))),F={class:"form-group pr-5 pl-5"},S=o((()=>(0,i._)("p",{for:"inputAddress2",class:"form-label"},"Place",-1))),U={key:0,class:"notification bg-danger mt-4 pr-5 pl-5",style:{color:"white"}},Z=o((()=>(0,i._)("hr",null,null,-1))),L=o((()=>(0,i._)("div",{id:"card-element",class:"m-5"},null,-1))),Q={key:1};function V(t,e,s,o,V,H){const N=(0,i.up)("CartItem");return(0,i.wg)(),(0,i.iD)("div",l,[(0,i._)("div",n,[c,(0,i._)("div",d,[H.cartTotalLength?((0,i.wg)(),(0,i.iD)("table",u,[p,(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(V.cart.items,(e=>((0,i.wg)(),(0,i.j4)(N,{key:e.product.id,initialItem:e,onRemoveFromCart:t.removeFromCart},null,8,["initialItem","onRemoveFromCart"])))),128))]),(0,i._)("tfoot",null,[(0,i._)("tr",null,[m,h,(0,i._)("td",null,(0,r.zw)(H.cartTotalLength),1),(0,i._)("td",null,"$"+(0,r.zw)(H.cartTotalPrice.toFixed(2)),1)])])])):(0,i.kq)("",!0)]),(0,i._)("div",_,[g,f,(0,i._)("div",w,[(0,i._)("div",y,[(0,i._)("div",v,[C,(0,i.wy)((0,i._)("input",{type:"email",class:"form-control",id:"inputEmail4",placeholder:"Email","onUpdate:modelValue":e[0]||(e[0]=t=>V.email=t)},null,512),[[a.nr,V.email]])]),(0,i._)("div",b,[k,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"inputPassword4",placeholder:"Phone Number","onUpdate:modelValue":e[1]||(e[1]=t=>V.phone=t)},null,512),[[a.nr,V.phone]])])]),(0,i._)("div",x,[(0,i._)("div",z,[D,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"inputCity","onUpdate:modelValue":e[2]||(e[2]=t=>V.first_name=t)},null,512),[[a.nr,V.first_name]])]),(0,i._)("div",T,[q,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"inputCity","onUpdate:modelValue":e[3]||(e[3]=t=>V.last_name=t)},null,512),[[a.nr,V.last_name]])]),(0,i._)("div",I,[$,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"inputZip","onUpdate:modelValue":e[4]||(e[4]=t=>V.zipcode=t)},null,512),[[a.nr,V.zipcode]])])]),(0,i._)("div",P,[A,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"inputAddress",placeholder:"1234 Main St","onUpdate:modelValue":e[5]||(e[5]=t=>V.address=t)},null,512),[[a.nr,V.address]])]),(0,i._)("div",F,[S,(0,i.wy)((0,i._)("input",{type:"text",class:"form-control",id:"inputAddress2",placeholder:"Apartment, studio, or floor","onUpdate:modelValue":e[6]||(e[6]=t=>V.place=t)},null,512),[[a.nr,V.place]])]),V.errors.length?((0,i.wg)(),(0,i.iD)("div",U,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(V.errors,(t=>((0,i.wg)(),(0,i.iD)("p",{key:t},(0,r.zw)(t),1)))),128))])):(0,i.kq)("",!0),Z,L,H.cartTotalLength?((0,i.wg)(),(0,i.iD)("div",Q,[(0,i._)("button",{class:"btn btn btn-success mt-3 mb-3",onClick:e[7]||(e[7]=(...t)=>H.submitForm&&H.submitForm(...t))},"Pay with Stripe")])):(0,i.kq)("",!0)])])])])}var H=s(6265),N=s.n(H),B=s(3860),E={name:"Checkout_",components:{CartItem:B.Z},data(){return{cart:{items:[]},stripe:{},card:{},first_name:"",last_name:"",email:"",phone:"",address:"",zipcode:"",place:"",errors:[]}},mounted(){if(document.title="Checkout | Anasazi",this.cart=this.$store.state.cart,this.cartTotalLength>0){this.stripe=window.Stripe("pk_test_51KfMtDCo5tQGz5JpkIZmtwCH9xiGit1BV4ONCSTQoDXWApnsZ9VGG59uhPQSZPT0jcQmBCr0cuUF2wxDdwdOffIK00S6Ww2xer");const t=this.stripe.elements();this.card=t.create("card",{hidePostalCode:!0}),this.card.mount("#card-element")}},methods:{getItemTotal(t){return t.quantity*t.price},submitForm(){this.errors=[],""===this.first_name&&this.errors.push("The first name field is missing!"),""===this.last_name&&this.errors.push("The last name field is missing!"),""===this.email&&this.errors.push("The email field is missing!"),""===this.phone&&this.errors.push("The phone field is missing!"),""===this.address&&this.errors.push("The address field is missing!"),""===this.zipcode&&this.errors.push("The zip code field is missing!"),""===this.place&&this.errors.push("The place field is missing!"),this.errors.length||(this.$store.commit("setIsLoading",!0),this.stripe.createToken(this.card).then((t=>{t.error?(this.$store.commit("setIsLoading",!1),this.errors.push("Something went wrong with Stripe. Please try again"),console.log("error is this",t.error.message)):this.stripeTokenHandler(t.token)})))},async stripeTokenHandler(t){console.log("hello");const e=[];for(let i=0;i<this.cart.items.length;i++){const t=this.cart.items[i],s={product:t.product.id,quantity:t.quantity,price:t.price*t.quantity};e.push(s)}const s={first_name:this.first_name,last_name:this.last_name,email:this.email,address:this.address,zipcode:this.zipcode,place:this.place,phone:this.phone,stripe_token:t.id,items:e};await N().post("/api/v1/checkout/",s).then((t=>{this.$store.commit("clearCart"),this.$router.push("/success"),console.log(t)})).catch((t=>{this.errors.push("Something went wrong. Please try again"),console.log(t,"err0or 2")})),this.$store.commit("setIsLoading",!1)}},computed:{cartTotalPrice(){return this.cart.items.reduce(((t,e)=>t+e.price*e.quantity),0)},cartTotalLength(){return this.cart.items.reduce(((t,e)=>t+e.quantity),0)}}},G=s(89);const K=(0,G.Z)(E,[["render",V],["__scopeId","data-v-6ca4a9d6"]]);var M=K}}]);
//# sourceMappingURL=695.42747322.js.map